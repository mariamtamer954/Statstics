<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Sleep Quality Data set analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Final.Edition_files/libs/clipboard/clipboard.min.js"></script>
<script src="Final.Edition_files/libs/quarto-html/quarto.js"></script>
<script src="Final.Edition_files/libs/quarto-html/popper.min.js"></script>
<script src="Final.Edition_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Final.Edition_files/libs/quarto-html/anchor.min.js"></script>
<link href="Final.Edition_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Final.Edition_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Final.Edition_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Final.Edition_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Final.Edition_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Final.Edition_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="Final.Edition_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="Final.Edition_files/libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="Final.Edition_files/libs/typedarray-0.1/typedarray.min.js"></script>

<script src="Final.Edition_files/libs/jquery-3.5.1/jquery.min.js"></script>

<link href="Final.Edition_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="Final.Edition_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="Final.Edition_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="Final.Edition_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>



</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction 💡</a>
  <ul class="collapse">
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective">Objective 💡</a></li>
  <li><a href="#read-libraries" id="toc-read-libraries" class="nav-link" data-scroll-target="#read-libraries">Read Libraries ☝</a></li>
  <li><a href="#read-excel-file" id="toc-read-excel-file" class="nav-link" data-scroll-target="#read-excel-file">Read Excel File</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning 👨🏻‍💻</a></li>
  </ul></li>
  <li><a href="#descriptive-analysis" id="toc-descriptive-analysis" class="nav-link" data-scroll-target="#descriptive-analysis">Descriptive Analysis 📊</a></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">Exploratory Analysis 🗝</a></li>
  <li><a href="#predictive-analysis" id="toc-predictive-analysis" class="nav-link" data-scroll-target="#predictive-analysis">Predictive Analysis 📈</a></li>
  <li><a href="#inferential-analysis" id="toc-inferential-analysis" class="nav-link" data-scroll-target="#inferential-analysis">Inferential Analysis 📈</a></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation 💡</a>
  <ul class="collapse">
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion:</a></li>
  </ul></li>
  <li><a href="#thanks-for-listening-our-brilliant-doctors" id="toc-thanks-for-listening-our-brilliant-doctors" class="nav-link" data-scroll-target="#thanks-for-listening-our-brilliant-doctors">Thanks for listening our brilliant Doctors ! ❤️</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sleep Quality Data set analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction 💡</h2>
<p>“Sleep Disorders Data Set” about sleep disorders which caused by Various factors as (Physical activity level _stress level_BMI_blood pressure_Daily steps ) all these factors are mentioned as variables in the data set There are more considerations can affect sleep disorder like age as it is said that as you become older your sleep quality decrease .Gender ,people think that Females Gain sleep quality more than Males . Occupation , there are sayings that people who work in medical Fields can’t attain high sleep quality and suffer from sleep disorders in this analysis we want to know which saying is a rumor and which is true . This analysis provides sufficient guide to know which factors affect more on sleep quality that lead to sleep disorders , it provides also visualizations to enhance knowledge through descriptive analysis ,know the relations between variables and the correlation between them through exploratory analysis . this analysis contain type of predictive analysis through regression analysis .</p>
<section id="objective" class="level3">
<h3 class="anchored" data-anchor-id="objective">Objective 💡</h3>
<p>This project aims to conduct a comprehensive analysis of sleep quality and disorders by investigating key variables such as Sleep Duration, Quality of Sleep, Physical Activity Level, Stress Level, BMI Category, Blood Pressure, Daily Steps, and Sleep Disorder.</p>
<ul>
<li><p>Examine the impact of Gender and Age on sleep patterns.</p></li>
<li><p>Analyze the relationship between Stress Levels and Sleep Duration to determine whether higher stress leads to shorter sleep.</p></li>
<li><p>Assess how Physical Activity Levels and Daily Steps influence sleep quality. Explore whether different Occupations affect sleep patterns and contribute to sleep disorders.</p></li>
<li><p>Use descriptive and exploratory analysis to uncover trends and correlations between variables.</p></li>
<li><p>Develop predictive models to identify factors that are most likely to cause sleep disorders and simulate scenarios to test findings.</p></li>
<li><p>This analysis seeks to deliver data-driven insights and actionable recommendations to improve sleep quality and overall&nbsp;well-being.</p></li>
</ul>
</section>
<section id="read-libraries" class="level3">
<h3 class="anchored" data-anchor-id="read-libraries">Read Libraries ☝</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missForest)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quarto)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read-excel-file" class="level3">
<h3 class="anchored" data-anchor-id="read-excel-file">Read Excel File</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span><span class="fu">read_xlsx</span>(<span class="st">"C:/Users/maria/Desktop/Stat Computing project/Sleep_health_and_lifestyle_dataset_project.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">Data Cleaning 👨🏻‍💻</h3>
<ul>
<li><p>Handle Missing Values</p></li>
<li><p>Handle Outliers</p></li>
<li><p>Handle Duplicated Rows</p></li>
<li><p>Handle Invalid Variables,coding errors</p></li>
<li><p>Extraneous Characters</p></li>
</ul>
<section id="detect-missing-values-in-the-data-set" class="level5">
<h5 class="anchored" data-anchor-id="detect-missing-values-in-the-data-set">Detect Missing Values in the data set</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find columns with NA values</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>na_columns <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data)[<span class="fu">colSums</span>(<span class="fu">is.na</span>(data)) <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display columns with NA values and their counts</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(na_columns) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Columns with NA values:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> na_columns) {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(col, <span class="st">":"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(data[[col]])), <span class="st">"missing values</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No missing values in the dataset.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Columns with NA values:
Gender : 1077 missing values
Age : 928 missing values
Occupation : 798 missing values
Sleep Duration : 935 missing values
Quality of Sleep : 946 missing values
Physical Activity Level : 964 missing values
Stress Level : 944 missing values
BMI Category : 867 missing values
Blood Pressure : 920 missing values
Heart Rate : 955 missing values
Daily Steps : 917 missing values
Sleep Disorder : 1049 missing values</code></pre>
</div>
</div>
</section>
<section id="modify-gender" class="level5">
<h5 class="anchored" data-anchor-id="modify-gender">Modify Gender</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">unique</span>(data)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mode for Gender</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>gender_mode <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(data<span class="sc">$</span>Gender, <span class="at">useNA =</span> <span class="st">"no"</span>)))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing cells with the mode</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Gender[<span class="fu">is.na</span>(data<span class="sc">$</span>Gender) <span class="sc">|</span> <span class="fu">trimws</span>(data<span class="sc">$</span>Gender) <span class="sc">==</span> <span class="st">""</span>] <span class="ot">&lt;-</span> gender_mode</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-age" class="level5">
<h5 class="anchored" data-anchor-id="modify-age">Modify Age</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove decimal points</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(data<span class="sc">$</span>Age)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace invalid values (outside 0 to 100) with NA</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>Age <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> data<span class="sc">$</span>Age <span class="sc">&gt;</span> <span class="dv">100</span>, <span class="cn">NA</span>, data<span class="sc">$</span>Age)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean of Age (ignoring NA)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing and invalid values with the mean</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Age[<span class="fu">is.na</span>(data<span class="sc">$</span>Age)] <span class="ot">&lt;-</span> <span class="fu">round</span>(mean_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-occupation" class="level5">
<h5 class="anchored" data-anchor-id="modify-occupation">Modify occupation</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mode for Occupation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>occupation_mode <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(data<span class="sc">$</span>Occupation, <span class="at">useNA =</span> <span class="st">"no"</span>)))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing cells with the mode</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Occupation[<span class="fu">is.na</span>(data<span class="sc">$</span>Occupation) <span class="sc">|</span> <span class="fu">trimws</span>(data<span class="sc">$</span>Occupation) <span class="sc">==</span> <span class="st">""</span>] <span class="ot">&lt;-</span> occupation_mode</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-sleep-duration" class="level5">
<h5 class="anchored" data-anchor-id="modify-sleep-duration">Modify sleep duration</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate the mode</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>calculate_mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  uniq_vals <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  uniq_vals[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(x, uniq_vals)))]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Sleep Duration' to numeric and calculate mode, ignoring NAs</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>sleep_duration_mode <span class="ot">&lt;-</span> <span class="fu">calculate_mode</span>(<span class="fu">na.omit</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the mode</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>[<span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>) <span class="sc">|</span> <span class="fu">trimws</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>) <span class="sc">==</span> <span class="st">""</span>] <span class="ot">&lt;-</span> sleep_duration_mode</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the column to 1 decimal place</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-quality-of-sleep" class="level5">
<h5 class="anchored" data-anchor-id="modify-quality-of-sleep">Modify quality of sleep</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Median</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>median_value <span class="ot">&lt;-</span> <span class="fu">median</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Medain In na Cell</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>[<span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>)] <span class="ot">&lt;-</span> median_value</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete decimale number</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-physical-activity-level" class="level5">
<h5 class="anchored" data-anchor-id="modify-physical-activity-level">Modify physical activity level</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Median</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>median_value <span class="ot">&lt;-</span> <span class="fu">median</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Physical Activity Level</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Medain In na Cell</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Physical Activity Level</span><span class="st">`</span>[<span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Physical Activity Level</span><span class="st">`</span>)] <span class="ot">&lt;-</span> median_value</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete decimale number</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Physical Activity Level</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Physical Activity Level</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-stress-level" class="level5">
<h5 class="anchored" data-anchor-id="modify-stress-level">Modify stress level</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>median_value <span class="ot">&lt;-</span> <span class="fu">median</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the median</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>[<span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>)] <span class="ot">&lt;-</span> median_value</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure values do not exceed 10, replace exceeding values with the median</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>[data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">10</span>] <span class="ot">&lt;-</span> median_value</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove decimal numbers by converting to integer</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-bmi-category" class="level5">
<h5 class="anchored" data-anchor-id="modify-bmi-category">Modify BMI category</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mode for BMI Category</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>BMI_Category_mode <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">BMI Category</span><span class="st">`</span>, <span class="at">useNA =</span> <span class="st">"no"</span>)))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing cells with the mode</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">BMI Category</span><span class="st">`</span>[<span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">BMI Category</span><span class="st">`</span>) <span class="sc">|</span> <span class="fu">trimws</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">BMI Category</span><span class="st">`</span>) <span class="sc">==</span> <span class="st">""</span>] <span class="ot">&lt;-</span> BMI_Category_mode</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-daily-steps" class="level5">
<h5 class="anchored" data-anchor-id="modify-daily-steps">Modify Daily steps</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(  data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">11000</span>, <span class="cn">NA</span>, data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Median</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>median_value <span class="ot">&lt;-</span> <span class="fu">median</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Medain In na Cell</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>[<span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>)] <span class="ot">&lt;-</span> median_value</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete decimale number</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-sleep-disorders" class="level5">
<h5 class="anchored" data-anchor-id="modify-sleep-disorders">Modify sleep disorders</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mode for Sleep Disorder</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Sleep_Disorder_mode <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>)))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing cells with the mode</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>[<span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>) <span class="sc">|</span> <span class="fu">trimws</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>) <span class="sc">==</span> <span class="st">""</span>] <span class="ot">&lt;-</span> Sleep_Disorder_mode</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modify-heart-rate" class="level5">
<h5 class="anchored" data-anchor-id="modify-heart-rate">Modify Heart rate</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Median</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>median_value <span class="ot">&lt;-</span> <span class="fu">median</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Heart Rate</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Medain In na Cell</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Heart Rate</span><span class="st">`</span>[<span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Heart Rate</span><span class="st">`</span>)] <span class="ot">&lt;-</span> median_value</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete decimale number</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="st">`</span><span class="at">Heart Rate</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Heart Rate</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="descriptive-analysis" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-analysis">Descriptive Analysis 📊</h2>
<section id="count-the-numbers-of-males-and-females-in-the-data-set-." class="level5">
<h5 class="anchored" data-anchor-id="count-the-numbers-of-males-and-females-in-the-data-set-.">1-count the numbers of males and females in the data set .</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gender_count <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>Gender)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Female   Male 
  4422   5578 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>gender_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>Gender)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'SkyBlue'</span>, <span class="st">'Lightgreen'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">labels =</span> <span class="fu">names</span>(gender_counts), <span class="at">values =</span> gender_counts, <span class="at">type =</span> <span class="st">"pie"</span>, <span class="at">hole =</span> <span class="fl">0.4</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">colors =</span> colors))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>figs <span class="ot">&lt;-</span> <span class="fu">layout</span>(fig, <span class="at">title =</span> <span class="st">'Gender percentage'</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>figs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-6e187bee81312c9f8b2b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6e187bee81312c9f8b2b">{"x":{"visdat":{"478810fd58f5":["function () ","plotlyVisDat"]},"cur_data":"478810fd58f5","attrs":{"478810fd58f5":{"labels":["Female","Male"],"values":[4422,5578],"hole":0.40000000000000002,"marker":{"colors":["SkyBlue","Lightgreen"]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Gender percentage","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["Female","Male"],"values":[4422,5578],"hole":0.40000000000000002,"marker":{"color":"rgba(31,119,180,1)","colors":["SkyBlue","Lightgreen"],"line":{"color":"rgba(255,255,255,1)"}},"type":"pie","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The male percentage is 55.8% which is more than the female percntage which is 44.2%</p>
</section>
<section id="what-is-age-distribution-of-indviduals" class="level5">
<h5 class="anchored" data-anchor-id="what-is-age-distribution-of-indviduals">2-What is age distribution of indviduals ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using histogram </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the density</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">density</span>(data<span class="sc">$</span>Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(density_plot,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Age Density of Individuals in the data set 'sleep disorders'"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Age"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The density increasing the age 40 is the highest with density 0.08 then the density is decreasing to age</p>
<p>60</p>
</section>
<section id="what-is-the-distribution-of-the-occupation" class="level5">
<h5 class="anchored" data-anchor-id="what-is-the-distribution-of-the-occupation">3-what is the distribution of the occupation ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>jobrole_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>Occupation)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>bar_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'orange'</span>, <span class="st">'lightblue'</span>, <span class="st">'pink'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightcoral'</span>, <span class="st">'lightcyan'</span>, <span class="st">'lightgoldenrod'</span>, <span class="st">'lightgray'</span>, <span class="st">'lightpink'</span>, <span class="st">'lightsalmon'</span>, <span class="st">'lightseagreen'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>fig_jobrole <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="fu">names</span>(jobrole_counts), <span class="at">y =</span> jobrole_counts, <span class="at">type =</span> <span class="st">"bar"</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> bar_colors))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>fig_jobrole <span class="ot">&lt;-</span> <span class="fu">layout</span>(fig_jobrole, <span class="at">title =</span> <span class="st">'Job Role Distribution'</span>, <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Occupation'</span>), <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Count'</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>fig_jobrole</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-507675ae9604040c0069" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-507675ae9604040c0069">{"x":{"visdat":{"478858f02bfc":["function () ","plotlyVisDat"]},"cur_data":"478858f02bfc","attrs":{"478858f02bfc":{"x":["Accountant","Doctor","Engineer","Lawyer","Manager","Nurse","Sales Representative","Salesperson","Scientist","Software Engineer","Teacher","Unkown"],"y":[953,1447,1231,1093,21,2432,51,778,91,103,824,976],"marker":{"color":["orange","lightblue","pink","lightgreen","lightcoral","lightcyan","lightgoldenrod","lightgray","lightpink","lightsalmon","lightseagreen"]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Job Role Distribution","xaxis":{"domain":[0,1],"automargin":true,"title":"Occupation","type":"category","categoryorder":"array","categoryarray":["Accountant","Doctor","Engineer","Lawyer","Manager","Nurse","Sales Representative","Salesperson","Scientist","Software Engineer","Teacher","Unkown"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Count"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Accountant","Doctor","Engineer","Lawyer","Manager","Nurse","Sales Representative","Salesperson","Scientist","Software Engineer","Teacher","Unkown"],"y":[953,1447,1231,1093,21,2432,51,778,91,103,824,976],"marker":{"color":["orange","lightblue","pink","lightgreen","lightcoral","lightcyan","lightgoldenrod","lightgray","lightpink","lightsalmon","lightseagreen"],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The occupation that has the most job role count is the nurse with 2432 count ,the occupation that has the least job role count is the manager which is nearly to 21 count</p>
</section>
<section id="what-is-the-average-stress-level-among-people-who-sleep-less-than-6-hours-per-night" class="level5">
<h5 class="anchored" data-anchor-id="what-is-the-average-stress-level-among-people-who-sleep-less-than-6-hours-per-night">4-What is the average stress level among people who sleep less than 6 hours per night?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>average_stress <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Stress_Level =</span> <span class="fu">mean</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(average_stress)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  Average_Stress_Level
                 &lt;dbl&gt;
1                 4.95</code></pre>
</div>
</div>
<p>The code analyzes a dataset to determine the average stress level among those who sleep less than 6 hours, achieving this by filtering the data and calculating the mean stress level for the filtered subset which average = 4.94 can be approximately 5 .</p>
</section>
<section id="what-is-the-average-daily-step-count-for-individuals-classified-as-overweight" class="level5">
<h5 class="anchored" data-anchor-id="what-is-the-average-daily-step-count-for-individuals-classified-as-overweight">5-What is the average daily step count for individuals classified as overweight?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>average_steps <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">BMI Category</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Overweight"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Daily_Steps =</span> <span class="fu">mean</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(average_steps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  Average_Daily_Steps
                &lt;dbl&gt;
1               6838.</code></pre>
</div>
</div>
<p>The R code calculates and displays the average daily step count for individuals classified as overweight based on data stored in a data frame which is equal 6838 .</p>
</section>
<section id="what-is-the-average-sleep-duration-across-all-individuals-calculate-the-mean-sleep-duration-excluding-missing-values" class="level5">
<h5 class="anchored" data-anchor-id="what-is-the-average-sleep-duration-across-all-individuals-calculate-the-mean-sleep-duration-excluding-missing-values">6-What is the average sleep duration across all individuals? Calculate the mean sleep duration (excluding missing values)</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>avg_sleep_duration <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Sleep =</span> <span class="fu">mean</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_sleep_duration)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  Average_Sleep
          &lt;dbl&gt;
1          7.14</code></pre>
</div>
</div>
<p>The R code calculates the average sleep duration for all individuals in the dataset, which is equal 7.13 daily .</p>
</section>
<section id="what-are-the-most-common-types-of-sleep-disorder" class="level5">
<h5 class="anchored" data-anchor-id="what-are-the-most-common-types-of-sleep-disorder">7-what are the most common types of sleep disorder?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>common_disorders <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(common_disorders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  `data$\`Sleep Disorder\``     n
  &lt;chr&gt;                     &lt;int&gt;
1 None                       6289
2 Sleep Apnea                1966
3 Insomnia                   1745</code></pre>
</div>
</div>
<p>The R code analyzes the dataset to identify the most common types of sleep disorders, achieving this by filtering out rows with missing sleep disorder data, counting the occurrences of each sleep disorder, and arranging the results in descending order, The highest is with none sleep disorder and the lowest is insomnia .</p>
</section>
<section id="what-occupations-report-the-highest-and-lowest-average-sleep-duration" class="level5">
<h5 class="anchored" data-anchor-id="what-occupations-report-the-highest-and-lowest-average-sleep-duration">8-What occupations report the highest and lowest average sleep duration?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average sleep duration by occupation</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>avg_sleep_by_occupation <span class="ot">&lt;-</span> data<span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data<span class="sc">$</span>Occupation) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Sleep =</span> <span class="fu">mean</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Sleep))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_sleep_by_occupation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   `data$Occupation`    Average_Sleep
   &lt;chr&gt;                        &lt;dbl&gt;
 1 Accountant                    7.14
 2 Doctor                        7.14
 3 Engineer                      7.14
 4 Lawyer                        7.14
 5 Manager                       7.14
 6 Nurse                         7.14
 7 Sales Representative          7.14
 8 Salesperson                   7.14
 9 Scientist                     7.14
10 Software Engineer             7.14
11 Teacher                       7.14
12 Unkown                        7.14</code></pre>
</div>
</div>
<p>The occupations are the same average of sleep which is 7.14</p>
</section>
<section id="what-is-the-average-stress-level-with-different-bmi-categagory" class="level5">
<h5 class="anchored" data-anchor-id="what-is-the-average-stress-level-with-different-bmi-categagory">9-what is the average stress level with different BMI categagory ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by BMI Category and calculate the mean Stress Level</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>td <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">BMI Category</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Stress_Level =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(td, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">BMI Category</span><span class="st">`</span>, <span class="at">y =</span> Average_Stress_Level, <span class="at">fill =</span> <span class="st">`</span><span class="at">BMI Category</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Stress Level by BMI Category"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"BMI Category"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Stress Level"</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The highest stress level occured in the overweight category and the lowest one is normal .over weight has the highest stress level.</p>
</section>
<section id="plot-the-quality-of-sleep-with-daily-steps" class="level5">
<h5 class="anchored" data-anchor-id="plot-the-quality-of-sleep-with-daily-steps">10-plot the quality of sleep with daily steps</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>scatter_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scatter Plot: Quality of Sleep vs Daily Steps"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Daily Steps"</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Quality of Sleep"</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatter_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>function (x, y, ...) 
UseMethod("plot")
&lt;bytecode: 0x000001c423a955d8&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
</div>
<p>There is No relation between quality of sleep and daily steps</p>
</section>
<section id="bar-chart-to-represent-occupation-with-stress-level" class="level5">
<h5 class="anchored" data-anchor-id="bar-chart-to-represent-occupation-with-stress-level">11-bar chart to represent occupation with stress level</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>avg_stress_by_occupation <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Occupation) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Stress_Level =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>bar_chart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(avg_stress_by_occupation, <span class="fu">aes</span>(<span class="at">x =</span> Occupation, <span class="at">y =</span> Average_Stress_Level, <span class="at">fill =</span> Occupation)) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Stress Level by Occupation"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Occupation"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Stress Level"</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bar_chart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The highest stress level is the scientist which is more than 6 while the least stress level is the engineer which is less than 4</p>
</section>
<section id="what-is-the-summary-of-all-variables" class="level5">
<h5 class="anchored" data-anchor-id="what-is-the-summary-of-all-variables">12-What is the summary of all variables?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Person ID        Gender               Age         Occupation       
 Min.   :    1   Length:10000       Min.   :24.00   Length:10000      
 1st Qu.: 2501   Class :character   1st Qu.:36.00   Class :character  
 Median : 5000   Mode  :character   Median :42.00   Mode  :character  
 Mean   : 5000                      Mean   :41.94                     
 3rd Qu.: 7500                      3rd Qu.:47.00                     
 Max.   :10000                      Max.   :64.00                     
 Sleep Duration  Quality of Sleep Physical Activity Level  Stress Level  
 Min.   :5.200   Min.   :3.000    Min.   :27.00           Min.   :2.000  
 1st Qu.:6.500   1st Qu.:6.000    1st Qu.:43.00           1st Qu.:4.000  
 Median :7.200   Median :7.000    Median :58.00           Median :5.000  
 Mean   :7.136   Mean   :6.822    Mean   :58.33           Mean   :4.946  
 3rd Qu.:7.800   3rd Qu.:8.000    3rd Qu.:75.00           3rd Qu.:6.000  
 Max.   :9.300   Max.   :9.000    Max.   :98.00           Max.   :8.000  
 BMI Category       Blood Pressure       Heart Rate     Daily Steps   
 Length:10000       Length:10000       Min.   :58.00   Min.   : 2701  
 Class :character   Class :character   1st Qu.:66.00   1st Qu.: 5688  
 Mode  :character   Mode  :character   Median :69.00   Median : 6807  
                                       Mean   :69.52   Mean   : 6838  
                                       3rd Qu.:73.00   3rd Qu.: 7724  
                                       Max.   :94.00   Max.   :10998  
 Sleep Disorder    
 Length:10000      
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
</section>
</section>
<section id="exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-analysis">Exploratory Analysis 🗝</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install GGally if not already installed</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude the "Person ID" column and select numeric data</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="ot">&lt;-</span> data[, <span class="fu">sapply</span>(data, is.numeric)]  <span class="co"># Select numeric columns</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="ot">&lt;-</span> numeric_data[, <span class="sc">!</span><span class="fu">colnames</span>(numeric_data) <span class="sc">%in%</span> <span class="st">"Person ID"</span>]  <span class="co"># Exclude "Person ID"</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatter plot matrix</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(numeric_data, <span class="at">title =</span> <span class="st">"Scatter Plot Matrix (Excluding Person ID)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="explore-which-gender-suffer-from-sleep-disorder-through-." class="level5">
<h5 class="anchored" data-anchor-id="explore-which-gender-suffer-from-sleep-disorder-through-.">1-Explore which Gender suffer from sleep disorder through .</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">fill =</span> <span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prevalence of Sleep Disorders by Gender"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Sleep disorder Proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The proportion of individuals without sleep disorders (“None”) appears to dominate in both genders.</p></li>
<li><p>The proportion of “Insomnia” is slightly higher in females than in males which indicates gender related reason</p></li>
<li><p>The proportion of “sleep Apnea” is higher in female</p></li>
</ul>
</section>
<section id="what-are-the-trends-in-sleep-duration-across-different-age-groups" class="level5">
<h5 class="anchored" data-anchor-id="what-are-the-trends-in-sleep-duration-across-different-age-groups">2-What are the trends in sleep duration across different age groups?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age groups</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age.Group =</span> <span class="fu">cut</span>(data<span class="sc">$</span>Age, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">29</span>, <span class="dv">39</span>, <span class="dv">49</span>, <span class="dv">59</span>, <span class="dv">69</span>, <span class="cn">Inf</span>),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60-64"</span>, <span class="st">"+"</span>)))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average sleep duration for each age group</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>age_sleep <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age.Group) <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Sleep =</span> <span class="fu">mean</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize trends in sleep duration across age groups</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(age_sleep, <span class="fu">aes</span>(<span class="at">x =</span> Age.Group, <span class="at">y =</span> Average_Sleep)) <span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Sleep Duration Across Age Groups"</span>, <span class="at">x =</span> <span class="st">"Age Group"</span>, <span class="at">y =</span> <span class="st">"Average Sleep Duration"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>This Bar char indicates that average sleep duration is the same across different age groups</p></li>
<li><p>It indicates that age is not a significant factor to sleep duration</p></li>
</ul>
</section>
<section id="what-is-the-correlation-between-sleep-duration-and-quality-of-sleep" class="level5">
<h5 class="anchored" data-anchor-id="what-is-the-correlation-between-sleep-duration-and-quality-of-sleep">3-what is the correlation between sleep duration and quality of sleep ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Correlation coefficient:"</span>, correlation))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation coefficient: 0.675047440065149"</code></pre>
</div>
</div>
<ul>
<li>There is a postive Moderate relationship between sleep duration and quality of sleep using correlation coefficient</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Correlation Between Sleep Duration and Sleep Quality"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sleep Duration (hours)"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sleep Quality (score)"</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Sleep duration is observed between 5 and 9 hours, and sleep quality scores range from 4 to 9</p></li>
<li><p>The red regression line indicates a positive linear relationship between sleep duration and sleep quality. As sleep duration increases, sleep quality also appears to improve.</p></li>
</ul>
</section>
<section id="sleep-disorder-distribution-according-to-stress-level" class="level5">
<h5 class="anchored" data-anchor-id="sleep-disorder-distribution-according-to-stress-level">4-sleep disorder distribution according to stress level ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span><span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">fill =</span><span class="st">`</span><span class="at">Sleep Disorder</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Boxplot of stress level by sleep disorder"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sleep Disorder "</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Stress Level"</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The median stress level is highest for individuals with Insomnia, and by those with Sleep Apnea. Individuals with no sleep disorder have the lowest median stress level</p></li>
<li><p>The max value of stress level caused by sleep apnea and isonomia</p></li>
<li><p>people with none sleep disorder has the lowest max value with stress</p></li>
</ul>
</section>
<section id="people-with-stress-according-to-occupation" class="level5">
<h5 class="anchored" data-anchor-id="people-with-stress-according-to-occupation">5-people with stress according to occupation</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span>Occupation, <span class="at">y =</span> <span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">fill =</span>Occupation)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Boxplot of stress by occupation "</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"occupation "</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"stress level "</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Through this box plot between occupation and stress level indicates that Engineer has the lowest strees level = 2 , and scientist has the highest stress =8</p></li>
<li><p>Some occupations, such as Engineer and Nurse , show a larger interquartile range, indicating more variability in stress levels within these groups</p></li>
</ul>
</section>
<section id="people-sleep-quality-with-their-occupation" class="level5">
<h5 class="anchored" data-anchor-id="people-sleep-quality-with-their-occupation">6-People sleep quality with their occupation</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span>Occupation, <span class="at">y =</span> <span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>, <span class="at">fill =</span>Occupation)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Boxplot of sleep quality by occupation "</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"occupation "</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Quality of sleep"</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>This box plot between Occupation and quality of sleep indicates that engineer attain highest sleep quality =9 while scientist has lowest sleep quality .</p></li>
<li><p>Nurse has more interquartile range which means variability in quality of sleep ion this occupation .</p></li>
</ul>
</section>
<section id="scatter-plot-between-quality-of-sleep-and-stress-level" class="level5">
<h5 class="anchored" data-anchor-id="scatter-plot-between-quality-of-sleep-and-stress-level">7-Scatter plot between quality of sleep and stress level ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Correlation Between Sleep Duration and Sleep Quality"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Stress Level "</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sleep Quality (score)"</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>This scatter plot indicates an negative linear relation ship between stress level and sleep quality</p></li>
<li><p>As stress level increase sleep quality decrease</p></li>
</ul>
</section>
<section id="is-there-is-a-relation-between-daily-steps-and-sleep-duration" class="level5">
<h5 class="anchored" data-anchor-id="is-there-is-a-relation-between-daily-steps-and-sleep-duration">8-Is there is a relation between daily steps and sleep Duration ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Correlation Between Daily Steps and Sleep Duration "</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Daily steps  "</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sleep Duration "</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The red trend line appears relatively flat, indicating a weak or negligible linear correlation between daily steps and sleep duration.</li>
</ul>
<!-- -->
<ul>
<li><p>The slope of the line suggests that an increase in daily steps does not substantially affect sleep duration</p></li>
<li><p>Most data points are concentrated between 4,000 and 8,000 daily steps and between 6 and 8 hours of sleep duration, indicating these ranges are the most common.</p></li>
</ul>
</section>
</section>
<section id="predictive-analysis" class="level2">
<h2 class="anchored" data-anchor-id="predictive-analysis">Predictive Analysis 📈</h2>
<section id="can-daily-steps-predict-sleep-duration" class="level5">
<h5 class="anchored" data-anchor-id="can-daily-steps-predict-sleep-duration">1-Can daily steps predict sleep duration ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">lm</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span><span class="sc">~</span> data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>, <span class="at">data =</span> data) </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = data$`Sleep Duration` ~ data$`Daily Steps`, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.99388 -0.66431  0.03513  0.61022  2.16321 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         7.348e+00  3.886e-02 189.095  &lt; 2e-16 ***
data$`Daily Steps` -3.096e-05  5.540e-06  -5.589 2.35e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8632 on 9998 degrees of freedom
Multiple R-squared:  0.003114,  Adjusted R-squared:  0.003015 
F-statistic: 31.23 on 1 and 9998 DF,  p-value: 2.348e-08</code></pre>
</div>
</div>
<ul>
<li><p>THERE IS a weak negative association between daily steps and sleep duration.</p></li>
<li><p>Daily steps explain only a very small portion (less than 0.3%) of the variability in sleep duration.</p></li>
</ul>
</section>
<section id="can-stress-level-predict-quality-of-sleep" class="level5">
<h5 class="anchored" data-anchor-id="can-stress-level-predict-quality-of-sleep">2-Can stress level predict quality of sleep ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">lm</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span><span class="sc">~</span> data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">data =</span> data) </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = data$`Quality of Sleep` ~ data$`Stress Level`, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.7942 -0.7405  0.1521  0.6790  2.2058 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          9.428375   0.025489   369.9   &lt;2e-16 ***
data$`Stress Level` -0.526833   0.004856  -108.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8531 on 9998 degrees of freedom
Multiple R-squared:  0.5407,    Adjusted R-squared:  0.5407 
F-statistic: 1.177e+04 on 1 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><p>There is a strong negative association between quality of sleep and stress level.</p></li>
<li><p>Quality of sleep is a significant predictor of Stress levels.</p></li>
<li><p>𝐻0: 𝛽1 = 0 [There is no linear relationship (the slope is zero).]</p></li>
<li><p>𝐻1: 𝛽1 ≠ 0 [There is a linear relationship (the slope is not zero).]</p></li>
<li><p>H1 is accepted</p></li>
</ul>
</section>
<section id="heart-rate-predict-quality-of-sleep" class="level5">
<h5 class="anchored" data-anchor-id="heart-rate-predict-quality-of-sleep">3-Heart rate predict quality of sleep</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">lm</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span><span class="sc">~</span> data<span class="sc">$</span><span class="st">`</span><span class="at">Heart Rate</span><span class="st">`</span>, <span class="at">data =</span> data) </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = data$`Quality of Sleep` ~ data$`Heart Rate`, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4756 -0.8742  0.0262  0.8233  4.4177 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       13.749700   0.145528   94.48   &lt;2e-16 ***
data$`Heart Rate` -0.099645   0.002087  -47.75   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.136 on 9998 degrees of freedom
Multiple R-squared:  0.1857,    Adjusted R-squared:  0.1856 
F-statistic:  2280 on 1 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><p>There are a strong negative association between heart rate and quality of sleep(-0.099599 )</p></li>
<li><p>The R-squared value 18.57% of the variability in quality of sleep can be explained by heart rate.</p></li>
<li><p>p-value is less than level of significance 0.05 so H1 is accepted so the model is significance</p></li>
</ul>
</section>
<section id="section" class="level5">
<h5 class="anchored" data-anchor-id="section"></h5>
</section>
</section>
<section id="inferential-analysis" class="level2">
<h2 class="anchored" data-anchor-id="inferential-analysis">Inferential Analysis 📈</h2>
<section id="does-gender-significantly-influence-sleep-quality" class="level5">
<h5 class="anchored" data-anchor-id="does-gender-significantly-influence-sleep-quality">1-Does gender significantly influence sleep quality?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># T-test to compare sleep quality by gender</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Quality of Sleep</span><span class="st">`</span> <span class="sc">~</span> data<span class="sc">$</span>Gender, <span class="at">data =</span> data)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  data$`Quality of Sleep` by data$Gender
t = 20.576, df = 8431.2, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group Female and group Male is not equal to 0
95 percent confidence interval:
 0.4727636 0.5723263
sample estimates:
mean in group Female   mean in group Male 
            7.113976             6.591431 </code></pre>
</div>
</div>
<ul>
<li><p>There are a significant difference in the quality of sleep between females and males.</p></li>
<li><p>Females in the study reported significantly better sleep quality than males.</p></li>
</ul>
</section>
<section id="is-sleep-duration-significantly-associated-with-age" class="level5">
<h5 class="anchored" data-anchor-id="is-sleep-duration-significantly-associated-with-age">2-Is sleep duration significantly associated with age?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>age_sleep_corr <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data<span class="sc">$</span>Age, data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_sleep_corr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data$Age and data$`Sleep Duration`
t = 28.033, df = 9998, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.2516803 0.2880248
sample estimates:
      cor 
0.2699487 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#using regression to know exactly by how </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear regression</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>lm_age <span class="ot">&lt;-</span> <span class="fu">lm</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span> <span class="sc">~</span> data<span class="sc">$</span>Age, <span class="at">data =</span> data)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = data$`Sleep Duration` ~ data$Age, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.06955 -0.63736  0.02959  0.60277  2.06264 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 5.9747158  0.0422476  141.42   &lt;2e-16 ***
data$Age    0.0276821  0.0009875   28.03   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8324 on 9998 degrees of freedom
Multiple R-squared:  0.07287,   Adjusted R-squared:  0.07278 
F-statistic: 785.8 on 1 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><p>The Pearson correlation analysis shows a correlation coefficient (r) of 0.27, there is a weak positive relationship between Age and Sleep Duration.</p></li>
<li><p>The regression show that Age significantly impacts Sleep Duration, with sleep increasing by 0.0277 hours for each year of age.</p></li>
<li><p>The relationship is highly significant (p &lt; 2e-16). However, the model explains only 7.27% of the variation in sleep duration, suggesting other factors are more influential.</p></li>
</ul>
</section>
<section id="does-daily-steps-has-an-effect-on-sleep-duration" class="level5">
<h5 class="anchored" data-anchor-id="does-daily-steps-has-an-effect-on-sleep-duration">3-Does daily steps has an effect on sleep duration ?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span><span class="sc">~</span> data<span class="sc">$</span><span class="st">`</span><span class="at">Daily Steps</span><span class="st">`</span>, <span class="at">data =</span> data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: data$`Sleep Duration`
                     Df Sum Sq Mean Sq F value    Pr(&gt;F)    
data$`Daily Steps`    1   23.3 23.2724  31.234 2.348e-08 ***
Residuals          9998 7449.6  0.7451                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>There are significant relationship between Daily Steps and Sleep Duration</p></li>
<li><p>(We reject the hypothesis 𝐻0)</p>
<h5 id="is-there-a-significant-relationship-between-sleep-duration-and-stress-levels" class="anchored">4-Is there a significant relationship between sleep duration and stress levels?</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data$`Sleep Duration` and data$`Stress Level`
t = -85.946, df = 9998, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6629699 -0.6404220
sample estimates:
     cor 
-0.65184 </code></pre>
</div>
</div>
<ul>
<li><p>There are a strong negative relationship between Sleep Duration and Stress Level.</p></li>
<li><p>Higher stress levels are associated with shorter sleep durations in the sample.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span><span class="fu">lm</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span> <span class="sc">~</span> data<span class="sc">$</span><span class="st">`</span><span class="at">Stress Level</span><span class="st">`</span>, <span class="at">data =</span> data)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = data$`Sleep Duration` ~ data$`Stress Level`, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8601 -0.4771 -0.0186  0.4399  2.0814 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          8.722256   0.019588  445.28   &lt;2e-16 ***
data$`Stress Level` -0.320732   0.003732  -85.95   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6556 on 9998 degrees of freedom
Multiple R-squared:  0.4249,    Adjusted R-squared:  0.4248 
F-statistic:  7387 on 1 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><p>There are a strong and significant negative relationship between Stress Level and Sleep Duration.</p></li>
<li><p>For every unit increase in Stress level, Sleep duration decreases by approximately 0.32 hours.</p></li>
<li><p>The p-value (&lt; 2e-16) indicates the relationship is highly significant</p></li>
<li><p>The model explains about 42.46% of the variation in sleep duration (R-squared = 0.4246), suggesting that stress level is a key factor influencing sleep duration</p></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation 💡</h2>
<section id="simulated-data-about-sleep-duration-of-size-1000" class="level5">
<h5 class="anchored" data-anchor-id="simulated-data-about-sleep-duration-of-size-1000">simulated data about sleep duration of size 1000</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>simulated_sleep <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="fu">mean</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">sd =</span> <span class="fu">sd</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram for the simulated data</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(simulated_sleep, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">main =</span> <span class="st">"Simulated Sleep Duration"</span>, <span class="at">xlab =</span> <span class="st">"Hours"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for the sample data</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Sleep Duration</span><span class="st">`</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">main =</span> <span class="st">" Sleep Duration"</span>, <span class="at">xlab =</span> <span class="st">"Hours"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simulation-for-the-occupation-variable" class="level5">
<h5 class="anchored" data-anchor-id="simulation-for-the-occupation-variable">simulation for the occupation variable</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>occupation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Accountant"</span>, <span class="st">"Doctor"</span>, <span class="st">"Engineer"</span>, <span class="st">"lawyer"</span>, <span class="st">"Manager"</span>,<span class="st">"Nurse"</span>,<span class="st">"SR"</span>,<span class="st">"Sales person"</span>,<span class="st">"scientist"</span>,<span class="st">"Software Engineer"</span>,<span class="st">"Teacher"</span>,<span class="st">"Unknown "</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>simulated_occupation <span class="ot">&lt;-</span> <span class="fu">sample</span>(occupation, <span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>,<span class="fl">0.2</span>, <span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bar plot for the simulated data </span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(simulated_occupation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>simulated_occupation
       Accountant            Doctor          Engineer            lawyer 
              113                67                64                39 
          Manager             Nurse      Sales person         scientist 
               67                75               163                76 
Software Engineer                SR           Teacher          Unknown  
               66                43               125               102 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(simulated_occupation), <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">main =</span> <span class="st">"Simulated Occupations"</span>, <span class="at">xlab =</span> <span class="st">"Occupation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final.Edition_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bar plot for the  data set </span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>jobrole_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>Occupation)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>bar_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'orange'</span>, <span class="st">'lightblue'</span>, <span class="st">'pink'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightcoral'</span>, <span class="st">'lightcyan'</span>, <span class="st">'lightgoldenrod'</span>, <span class="st">'lightgray'</span>, <span class="st">'lightpink'</span>, <span class="st">'lightsalmon'</span>, <span class="st">'lightseagreen'</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>fig_jobrole <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="fu">names</span>(jobrole_counts), <span class="at">y =</span> jobrole_counts, <span class="at">type =</span> <span class="st">"bar"</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> bar_colors))</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>fig_jobrole <span class="ot">&lt;-</span> <span class="fu">layout</span>(fig_jobrole, <span class="at">title =</span> <span class="st">'Job Role Distribution'</span>, <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Occupation'</span>), <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Count'</span>))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>fig_jobrole</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d6c54c1de9751fb7103e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d6c54c1de9751fb7103e">{"x":{"visdat":{"47883f3520d2":["function () ","plotlyVisDat"]},"cur_data":"47883f3520d2","attrs":{"47883f3520d2":{"x":["Accountant","Doctor","Engineer","Lawyer","Manager","Nurse","Sales Representative","Salesperson","Scientist","Software Engineer","Teacher","Unkown"],"y":[953,1447,1231,1093,21,2432,51,778,91,103,824,976],"marker":{"color":["orange","lightblue","pink","lightgreen","lightcoral","lightcyan","lightgoldenrod","lightgray","lightpink","lightsalmon","lightseagreen"]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Job Role Distribution","xaxis":{"domain":[0,1],"automargin":true,"title":"Occupation","type":"category","categoryorder":"array","categoryarray":["Accountant","Doctor","Engineer","Lawyer","Manager","Nurse","Sales Representative","Salesperson","Scientist","Software Engineer","Teacher","Unkown"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Count"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Accountant","Doctor","Engineer","Lawyer","Manager","Nurse","Sales Representative","Salesperson","Scientist","Software Engineer","Teacher","Unkown"],"y":[953,1447,1231,1093,21,2432,51,778,91,103,824,976],"marker":{"color":["orange","lightblue","pink","lightgreen","lightcoral","lightcyan","lightgoldenrod","lightgray","lightpink","lightsalmon","lightseagreen"],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion:</h3>
<p><br>
This analysis provides valuable insights into the factors influencing sleep quality and the prevalence of sleep disorders. The results highlight significant relationships between Sleep Duration, Stress Levels, Physical Activity, BMI Category, and Daily Steps, demonstrating how lifestyle and health metrics impact sleep patterns.</p>
<p>Gender and Age influence sleep quality, with variations observed across different demographics. Stress Levels are inversely related to Sleep Duration, suggesting that higher stress leads to shorter and potentially lower-quality sleep. Physical Activity and Daily Steps show a positive correlation with better sleep quality, emphasizing the role of an active lifestyle in promoting healthier sleep. Occupations associated with irregular working hours, such as nurses and doctors, exhibit higher instances of sleep disorders, reflecting the impact of work-life balance on rest. Predictive modeling further strengthens the ability to identify individuals at risk of sleep disorders, offering opportunities for early intervention.</p>
<p>Final Recommendation: Promoting physical activity, managing stress levels, and encouraging healthier lifestyle choices can significantly improve sleep quality. Employers and healthcare providers should also consider workplace adjustments and targeted programs to address sleep-related issues, especially in high-risk professions.</p>
<p>This study serves as a foundation for further research and practical solutions to enhance sleep health and overall&nbsp;well-being.</p>
</section>
</section>
<section id="thanks-for-listening-our-brilliant-doctors" class="level1">
<h1>Thanks for listening our brilliant Doctors ! ❤️</h1>
<p><img src="حلمي.jpg" class="img-fluid"></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>